FROM metadatacenter/cedar-microservice:2.6.16

ENV CEDAR_SERVER_NAME=internals

ENV CEDAR_INTERNALS_HTTP_PORT=9014
ENV CEDAR_INTERNALS_ADMIN_PORT=9114
ENV CEDAR_INTERNALS_STOP_PORT=9214

ENV LOGDIR=${CEDAR_HOME}/log/cedar-${CEDAR_SERVER_NAME}-server/
RUN mkdir -p ${LOGDIR}
VOLUME ${LOGDIR}

RUN yum install -y python-redis

ADD scripts/pre-docker-entrypoint.sh ${CEDAR_HOME}/

EXPOSE ${CEDAR_INTERNALS_HTTP_PORT} ${CEDAR_INTERNALS_ADMIN_PORT} ${CEDAR_INTERNALS_STOP_PORT}

RUN ${CEDAR_HOME}/install_deps.sh
